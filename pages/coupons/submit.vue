<template>
  <div class="container w-full justify-center px-6 lg:px-0">
    <div class="coupon-submit mb-8 flex w-full max-w-3xl justify-center">
      <form class="coupon-form w-100 divide-y divide-gray-200" @submit.prevent="submitCoupon">
        <div class="space-y-8 divide-y divide-gray-200">
          <div>
            <div class="mt-6">
              <h3 class="submit-title text-xl font-medium leading-6 text-gray-900">å¡«å¯«å„ªæƒ åˆ¸</h3>
              <!-- èªªæ˜å€å¡Š -->
            <div class="info-banner">
              <div class="info-header">
                <Icon name="mdi:information-outline" />
                <h4>å¡«å¯«èªªæ˜</h4>
              </div>
              <p class="info-description">
                å¡«å¯«ä»¥ä¸‹è³‡æ–™ä¸¦ä¸Šå‚³åœ–ç‰‡ï¼Œå¡«å¯«å¾Œç¶“éå¯©æ ¸ï¼ˆç´„ 3â€“7 å€‹å·¥ä½œå¤©ï¼‰å³å¯åœ¨ã€Œå®œè˜­æ—…éŠé€šã€å¹³å°ä¸Šæ¶ã€‚
                ä¸€èµ·åˆ†äº«å¥½åº·ã€æ¨å»£åœ¨åœ°å¥½åº— ğŸ’š
              </p>
            </div>
            </div>

            <div class="mt-6 grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-6">
              <!-- å„ªæƒ åˆ¸åç¨± -->
              <section class="col-md-12 submit-part">
                <label for="title" class="submit-name block text-sm font-medium text-gray-700">
                  <TipIcon/>å„ªæƒ åˆ¸åç¨±ï¼š
                </label>
                <div class="mt-1">
                  <input
                    id="title"
                    v-model="form.title"
                    placeholder="è«‹è¼¸å…¥å„ªæƒ åˆ¸åç¨±"
                    name="title"
                    type="text"
                    required
                    class="w-100 block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500 sm:text-sm"
                  />
                </div>
              </section>

              <!-- å•†å®¶åç¨± -->
              <section class="col-md-12 submit-part">
                <label for="business_name" class="submit-name block text-sm font-medium text-gray-700">
                  <TipIcon/>å•†å®¶åç¨±ï¼š
                </label>
                <div class="mt-1">
                  <input
                    id="business_name"
                    v-model="form.business_name"
                    placeholder="è«‹è¼¸å…¥å•†å®¶æˆ–åº—å®¶åç¨±"
                    name="business_name"
                    type="text"
                    required
                    class="w-100 block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500 sm:text-sm"
                  />
                </div>
              </section>

              <!-- åˆ†é¡ -->
              <section class="col-md-12 submit-part">
                <label for="category" class="submit-name block text-sm font-medium text-gray-700">
                  <TipIcon/>åˆ†é¡ï¼š
                </label>
                <select class="submit-category border shadow-sm w-100 py-2 px-3 mt-1 rounded-md" v-model="form.category_id">
                  <option value="">è«‹é¸æ“‡åˆ†é¡</option>
                  <option v-for="cate in category" :key="cate.id" :value="cate.id">{{ cate.name }}</option>
                </select>
              </section>

              <!-- åœ°å€ -->
              <section class="col-md-12 submit-part">
                <label for="adress" class="submit-name block text-sm font-medium text-gray-700">
                  <TipIcon/>åœ°å€ï¼š
                </label>
                <textarea
                  id="adress"
                  v-model="form.adress"
                  placeholder="è«‹è¼¸å…¥å•†å®¶åœ°å€"
                  name="adress"
                  rows="2"
                  class="w-100 block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500 sm:text-sm"
                />
              </section>

              <!-- ç¶“ç·¯åº¦ -->
              <section class="col-md-12 submit-part">
                <label for="position" class="submit-name block text-sm font-medium text-gray-700">
                  <TipIcon/>ç¶“ç·¯åº¦(ä¾‹å¦‚: 24.63567884891394, 121.79100640000001):
                </label>
                <div class="mt-1">
                  <input
                    id="position"
                    v-model="form.position"
                    placeholder="è«‹è¼¸å…¥ç¶“ç·¯åº¦(google åœ°åœ–ä½¿ç”¨)"
                    name="position"
                    type="text"
                    class="w-100 block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500 sm:text-sm"
                  />
                  <small class="text-gray-500">å¯ä»¥å¾ Google åœ°åœ–ç²å–ç¶“ç·¯åº¦åº§æ¨™</small>
                </div>
              </section>

              <!-- é„‰é® -->
              <section class="col-md-12 submit-part">
                <label for="township" class="submit-name block text-sm font-medium text-gray-700">
                  <TipIcon/>é„‰é®ï¼š
                </label>
                <textarea
                  id="township"
                  v-model="form.township"
                  placeholder="è«‹è¼¸å…¥é„‰é®"
                  name="township"
                  rows="2"
                  class="w-100 block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500 sm:text-sm"
                />
              </section>

              <!-- ç™¼æ”¾æ•¸é‡ -->
              <section class="col-md-12 submit-part">
                <label for="amount" class="submit-name block text-sm font-medium text-gray-700">
                  <TipIcon/>ç™¼æ”¾æ•¸é‡ï¼š
                </label>
                <div class="mt-1">
                  <input
                    id="amount"
                    v-model.number="form.amount"
                    placeholder="è¼¸å…¥ç™¼æ”¾æ•¸é‡"
                    name="amount"
                    type="number"
                    min="1"
                    class="w-100 block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500 sm:text-sm"
                  />
                </div>
              </section>

              <!-- æ˜¯å¦é¡¯ç¤ºæ¨è–¦åº—å®¶ -->
              <section class="col-md-12 submit-part">
                <label class="submit-name block text-sm font-medium text-gray-700">
                  <TipIcon/>æ˜¯å¦éœ€é¡¯ç¤ºæ¨è–¦åº—å®¶ï¼š
                </label>
                <div class="mt-2 flex gap-4">
                  <label class="inline-flex items-center">
                    <input type="radio" value="true" v-model="form.isReferral" class="mr-2">
                    æ˜¯
                  </label>
                  <label class="inline-flex items-center">
                    <input type="radio" value="false" v-model="form.isReferral" class="mr-2">
                    å¦
                  </label>
                </div>
              </section>

              <!-- ä¸€å€‹å¸³è™Ÿåªèƒ½é ˜ä¸€æ¬¡ -->
              <section class="col-md-12 submit-part">
                <label class="submit-name block text-sm font-medium text-gray-700">
                  <TipIcon/>ä¸€å€‹å¸³è™Ÿåªèƒ½é ˜ä¸€æ¬¡ï¼š
                </label>
                <div class="mt-2 flex gap-4">
                  <label class="inline-flex items-center">
                    <input type="radio" value="true" v-model="form.isonce" class="mr-2">
                    æ˜¯
                  </label>
                  <label class="inline-flex items-center">
                    <input type="radio" value="false" v-model="form.isonce" class="mr-2">
                    å¦
                  </label>
                </div>
              </section>

              <!-- åœ–ç‰‡ä¸Šå‚³å€åŸŸ -->
              <section class="col-md-12 submit-part">
                <label class="submit-name block text-sm font-medium text-gray-700">
                  <TipIcon/>è«‹ä¸Šå‚³ä»£è¡¨æ€§åœ–ç‰‡ï¼š
                </label>
                
                <div class="upload-steps">
                  <p class="upload-step">
                    <span class="step-index">1.</span>
                    å·²æœ‰åœ–ç‰‡ç¶²å€ï¼Ÿè«‹è²¼ä¸Š URLã€‚
                  </p>
                  <p class="upload-step">
                    <span class="step-index">2.</span>
                    æ²’æœ‰ç¶²å€ï¼Ÿæ”¹ç”¨ä¸‹æ–¹ä¸Šå‚³åœ–ç‰‡æª”ã€‚
                  </p>
                </div>

                <!-- åœ–ç‰‡ URL è¼¸å…¥ -->
                <div class="mt-2">
                  <div class="flex gap-2">
                    <input
                      v-model="coverUrl"
                      placeholder="æˆ–è¼¸å…¥åœ–ç‰‡ URL"
                      type="text"
                      class="flex-1 block appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500 sm:text-sm"
                      @keyup.enter="addCoverUrl"
                    />
                    <button 
                      @click.prevent="addCoverUrl" 
                      class="add-url-btn"
                      :disabled="!coverUrl"
                    >
                      æ·»åŠ  URL
                    </button>
                  </div>
                </div>

                <!-- æª”æ¡ˆä¸Šå‚³ -->
                <div class="mt-3">
                  <input 
                    type="file" 
                    @change="handleFileUpload" 
                    accept="image/*" 
                    multiple 
                    class="block w-full text-sm text-gray-500
                      file:mr-4 file:py-2 file:px-4
                      file:rounded-full file:border-0
                      file:text-sm file:font-semibold
                      file:bg-emerald-50 file:text-emerald-700
                      hover:file:bg-emerald-100"
                  />
                </div>

                <!-- åœ–ç‰‡é è¦½ -->
                <div class="submit-img mt-4 grid grid-cols-2 gap-4 sm:grid-cols-3 md:grid-cols-4">
                  <div v-for="(url, index) in form.cover" :key="index" class="relative">
                    <img :src="url" :alt="'åœ–ç‰‡ ' + (index + 1)" class="w-full h-32 object-cover rounded-lg shadow-sm" />
                    <button 
                      @click.prevent="removeImage(index)" 
                      class="absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 shadow-md"
                    >
                      Ã—
                    </button>
                  </div>
                </div>
              </section>

              <!-- å„ªæƒ åˆ¸å…§å®¹ -->
              <section class="col-md-12 submit-part">
                <label for="content" class="submit-name block text-sm font-medium text-gray-700">
                  <TipIcon/>å„ªæƒ åˆ¸å…§å®¹ï¼š
                </label>
                <div class="mt-1">
                  <textarea
                    id="content"
                    v-model="form.content"
                    name="content"
                    rows="4"
                    required
                    placeholder="è«‹è©³ç´°æè¿°å„ªæƒ åˆ¸å…§å®¹ã€ä½¿ç”¨æ–¹å¼ç­‰..."
                    class="w-100 block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500 sm:text-sm"
                  />
                </div>
              </section>

              <!-- æ¨™ç±¤ -->
              <section class="col-md-12 submit-part">
                <label for="tags" class="submit-name block text-sm font-medium text-gray-700">
                  <TipIcon/>æ¨™ç±¤ï¼š
                </label>
                <div class="mt-1">
                  <textarea
                    id="tags"
                    v-model="form.tags"
                    name="tags"
                    rows="2"
                    placeholder="è«‹ç”¨#æ’°å¯«æ¨™ç±¤ï¼Œä¾‹å¦‚ï¼š#ç¾é£Ÿ #ç‰¹æƒ  #é™æ™‚"
                    class="w-100 block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500 sm:text-sm"
                  />
                </div>
              </section>

              <!-- æ˜¯å¦æœ‰åºè™Ÿ -->
              <section class="col-md-12 submit-part">
                <label class="submit-name block text-sm font-medium text-gray-700">
                  <TipIcon/>æ˜¯å¦æœ‰åºè™Ÿï¼š
                </label>
                <div class="mt-2 flex gap-4">
                  <label class="inline-flex items-center">
                    <input type="radio" value="true" v-model="form.hash" class="mr-2">
                    æ˜¯
                  </label>
                  <label class="inline-flex items-center">
                    <input type="radio" value="false" v-model="form.hash" class="mr-2">
                    å¦
                  </label>
                </div>
              </section>

              <!-- å¡«å¯«è€…è³‡è¨Š -->
              <section class="col-span-full submit-part submitter-section">
                <div class="submitter-header">
                  <Icon name="mdi:account-circle-outline" />
                  <h4>å¡«å¯«è€…è³‡è¨Š</h4>
                </div>
                
                <div class="submitter-fields">
                  <div class="field-group">
                    <label for="submitter_name" class="submit-name">
                      <TipIcon />æ‚¨çš„å§“å/æš±ç¨±ï¼š
                    </label>
                    <input 
                      id="submitter_name"
                      v-model="form.submitter_name" 
                      type="text" 
                      placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“åæˆ–æš±ç¨±"
                      required 
                      class="w-100 block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500 sm:text-sm"
                    />
                  </div>

                  <div class="field-group">
                    <label for="submitter_email" class="submit-name">
                      <TipIcon />é›»å­éƒµä»¶ï¼š
                    </label>
                    <input 
                      id="submitter_email"
                      v-model="form.submitter_email" 
                      type="email" 
                      placeholder="æ‚¨çš„é›»å­éƒµä»¶åœ°å€ï¼ˆé¸å¡«ï¼‰"
                      class="w-100 block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-emerald-500 focus:outline-none focus:ring-emerald-500 sm:text-sm"
                    />
                  </div>
                </div>
              </section>
            </div>
          </div>
        </div>

        <div class="pt-5">
          <div class="submit-button flex justify-between">
            <button type="button" @click="resetForm" class="btn btn-light shadow-sm">
              <Icon name="mdi:refresh" class="inline-block mr-1" />
              é‡è¨­è¡¨å–®
            </button>
            <button
              type="submit"
              :disabled="submitting"
              class="ml-3 btn btn-info text-white shadow-sm flex items-center gap-2"
            >
              <Icon v-if="submitting" name="eos-icons:loading" />
              <Icon v-else name="mdi:send" />
              {{ submitting ? 'å¡«å¯«ä¸­...' : 'å¡«å¯«å¯©æ ¸' }}
            </button>
          </div>
        </div>
      </form>
    </div>

    <!-- æˆåŠŸå¡«å¯«çš„æ¨¡æ…‹æ¡† -->
    <div v-if="showSuccessModal" class="modal-overlay" @click="closeSuccessModal">
      <div class="modal-content" @click.stop>
        <div class="modal-header">
          <Icon name="mdi:check-circle" class="success-icon" />
          <h3>å¡«å¯«æˆåŠŸï¼</h3>
        </div>
        <div class="modal-body">
          <p>æ‚¨çš„å„ªæƒ åˆ¸å·²æˆåŠŸå¡«å¯«ï¼Œæˆ‘å€‘æœƒåœ¨ 1-3 å€‹å·¥ä½œå¤©å…§é€²è¡Œå¯©æ ¸ã€‚</p>
          <p>å¯©æ ¸çµæœå°‡é€éæ‚¨æä¾›çš„è¯çµ¡æ–¹å¼é€šçŸ¥ã€‚</p>
        </div>
        <div class="modal-actions">
          <button @click="closeSuccessModal" class="px-6 py-2 bg-emerald-600 text-white rounded-md hover:bg-emerald-700">
            ç¢ºå®š
          </button>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, reactive } from 'vue'
import { category } from '~/utils/category'

// è¨­å®šé é¢æ¨™é¡Œ
useHead({
  title: 'å¡«å¯«å„ªæƒ åˆ¸ - å®œè˜­æ—…éŠç¶²',
  meta: [
    { name: 'description', content: 'åˆ†äº«æ‚¨çš„å„ªæƒ åˆ¸çµ¦å…¶ä»–æ—…å®¢ï¼Œè±å¯Œå®œè˜­æ—…éŠé«”é©—' }
  ]
})

// éŸ¿æ‡‰å¼è³‡æ–™
const submitting = ref(false)
const showSuccessModal = ref(false)
const coverUrl = ref('')

// è¡¨å–®è³‡æ–™
const form = reactive({
  title: '',
  content: '',
  business_name: '',
  category_id: '',
  adress: '',
  township: '',
  position: '',
  amount: 1000,
  cover: [],
  isReferral: 'false',
  isonce: 'true',
  tags: '',
  hash: 'false',
  submitter_name: '',
  submitter_email: '',
  usedTimes: 0
})

// è™•ç†åœ–ç‰‡ä¸Šå‚³
const handleFileUpload = async (event) => {
  const files = event.target.files
  if (!files.length) return

  for (let file of files) {
    try {
      console.log('é–‹å§‹ä¸Šå‚³æ–‡ä»¶:', file.name)
      
      // é©—è­‰æ–‡ä»¶é¡å‹
      const allowedTypes = ['image/jpeg', 'image/png', 'image/gif']
      if (!allowedTypes.includes(file.type)) {
        alert('åªå…è¨±ä¸Šå‚³ JPEGã€PNG å’Œ GIF æ ¼å¼çš„åœ–ç‰‡')
        continue
      }

      // é©—è­‰æ–‡ä»¶å¤§å° (5MB)
      const maxSize = 5 * 1024 * 1024
      if (file.size > maxSize) {
        alert('æ–‡ä»¶å¤ªå¤§ï¼Œæœ€å¤§å…è¨± 5MB')
        continue
      }

      // å‰µå»º FormData
      const formData = new FormData()
      formData.append('file', file)

      // ä¸Šå‚³åˆ°å¾Œç«¯ API
      const response = await fetch('/api/upload', {
        method: 'POST',
        body: formData
      })

      const data = await response.json()

      if (!data.success) {
        throw new Error(data.error || 'ä¸Šå‚³å¤±æ•—')
      }

      console.log('ä¸Šå‚³æˆåŠŸ:', data.url)
      form.cover.push(data.url)

    } catch (error) {
      console.error('ä¸Šå‚³éŒ¯èª¤:', error)
      alert(`ä¸Šå‚³å¤±æ•—ï¼š${error.message}`)
    }
  }
}

// æ·»åŠ åœ–ç‰‡ URL
const addCoverUrl = () => {
  if (coverUrl.value.trim()) {
    try {
      new URL(coverUrl.value)
      form.cover.push(coverUrl.value.trim())
      coverUrl.value = ''
    } catch (e) {
      alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„åœ–ç‰‡ URL')
    }
  }
}

// ç§»é™¤åœ–ç‰‡
const removeImage = (index) => {
  form.cover.splice(index, 1)
}

// é‡è¨­è¡¨å–®
const resetForm = () => {
  if (confirm('ç¢ºå®šè¦é‡è¨­è¡¨å–®ï¼Ÿæ‰€æœ‰è³‡æ–™å°‡æœƒæ¸…é™¤ã€‚')) {
    Object.keys(form).forEach(key => {
      if (key === 'amount') {
        form[key] = 1000
      } else if (key === 'isonce') {
        form[key] = 'true'
      } else if (key === 'isReferral') {
        form[key] = 'false'
      } else if (key === 'hash') {
        form[key] = 'false'
      } else if (key === 'usedTimes') {
        form[key] = 0
      } else if (key === 'cover') {
        form[key] = []
      } else {
        form[key] = ''
      }
    })
    coverUrl.value = ''
  }
}

// å¡«å¯«å„ªæƒ åˆ¸
const submitCoupon = async () => {
  try {
    submitting.value = true

    // è™•ç†åœ–ç‰‡ - å–å¾—ç¬¬ä¸€å¼µåœ–ç‰‡ URL
    let coverUrl = null
    if (form.cover && form.cover.length > 0) {
      coverUrl = form.cover[0]
    }

    // ä½¿ç”¨ $fetch ç™¼é€ JSON
    const response = await $fetch('/api/coupons/submit', {
      method: 'POST',
      body: {
        title: form.title,
        content: form.content,
        business_name: form.business_name,
        submitter_name: form.submitter_name,
        submitter_email: form.submitter_email,
        category_id: form.category_id,
        address: form.adress,
        township: form.township,
        tags: form.tags,
        position: form.position,
        amount: form.amount,
        isonce: form.isonce === 'true',
        isReferral: form.isReferral === 'true',
        cover_url: coverUrl
      }
    })

    if (response.success) {
      showSuccessModal.value = true
      resetForm()
    } else {
      throw new Error(response.message || 'å¡«å¯«å¤±æ•—')
    }

  } catch (error) {
    console.error('å¡«å¯«å„ªæƒ åˆ¸å¤±æ•—:', error)
    alert('å¡«å¯«å¤±æ•—ï¼š' + (error.data?.message || error.message || 'è«‹ç¨å¾Œå†è©¦'))
  } finally {
    submitting.value = false
  }
}

// é—œé–‰æˆåŠŸæ¨¡æ…‹æ¡†
const closeSuccessModal = () => {
  showSuccessModal.value = false
}
</script>

<style lang="scss" scoped>
.user-info {
  z-index: 1;
}

.container {
  background: #f6f7f9;
  min-height: 100vh;
  padding-top: 2rem;
  padding-bottom: 2rem;
}

.coupon-submit {
  display: flex;
  justify-content: center;
}

// æ–°å¢èªªæ˜å€å¡Šæ¨£å¼
.info-banner {
  background: #f0fdfa;
  border-left: 4px solid #0f766e;
  border-radius: 8px;
  padding: 16px 20px;
  margin-bottom: 24px;

  .info-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;

    svg {
      font-size: 20px;
      color: #0f766e;
    }

    h4 {
      font-size: 16px;
      font-weight: 600;
      color: #0f766e;
      margin: 0;
    }
  }

  .info-description {
    color: #374151;
    font-size: 14px;
    line-height: 1.6;
    margin: 0;
  }
}

// éŸ¿æ‡‰å¼è¨­è¨ˆ
@media (max-width: 768px) {
  .info-banner {
    padding: 14px 16px;

    .info-header {
      h4 {
        font-size: 15px;
      }

      svg {
        font-size: 18px;
      }
    }

    .info-description {
      font-size: 13px;
    }
  }
}

// å¡«å¯«è€…è³‡è¨Šå€å¡Šæ¨£å¼
.submitter-section {
  margin-top: 32px;
  padding-top: 24px;
  border-top: 2px solid #e5e7eb;
  
  .submitter-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 20px;
    padding-left: 4px;
    
    svg {
      color: #0f766e;
      font-size: 24px;
    }
    
    h4 {
      font-size: 18px;
      font-weight: 600;
      color: #1f2937;
      margin: 0;
    }
  }
  
  .submitter-fields {
    display: grid;
    gap: 16px;
    
    .field-group {
      label {
        display: flex;
        align-items: center;
        gap: 4px;
        font-size: 14px;
        font-weight: 500;
        color: #374151;
        margin-bottom: 8px;
      }
      
      input {
        width: 100%;
        padding: 10px 14px;
        font-size: 14px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        transition: all 0.15s ease-in-out;
        
        &::placeholder {
          color: #9ca3af;
        }
        
        &:focus {
          outline: none;
          border-color: #0f766e;
          box-shadow: 0 0 0 3px rgba(15, 118, 110, 0.1);
        }
      }
    }
  }
}

@media (max-width: 768px) {
  .submitter-section {
    margin-top: 24px;
    padding-top: 20px;
    
    .submitter-header {
      margin-bottom: 16px;
      
      svg {
        font-size: 22px;
      }
      
      h4 {
        font-size: 16px;
      }
    }
    
    .submitter-fields {
      gap: 14px;
      
      .field-group {
        label {
          font-size: 13px;
        }
        
        input {
          padding: 9px 12px;
          font-size: 13px;
        }
      }
    }
  }
}

.submit-title {
  font-size: 30px;
  font-weight: 700;
  color: #0f766e;
  margin-bottom: 6px;
}

.submit-subtitle {
  color: #5f6b7a;
  line-height: 1.6;
  font-size: 15px;
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 0.75rem 0;
}

.coupon-form {
  background: #ffffff;
  border-radius: 16px;
  padding: 36px;
  box-shadow: 0 12px 32px rgba(15, 118, 110, 0.08);
  border: 1px solid rgba(15, 118, 110, 0.08);
}

.submit-name {
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 10px;
  color: #2b3440;
  display: flex;
  align-items: center;
  gap: 4px;
}

.submit-category {
  display: block;
  height: 44px;
  border: 1px solid #d4d9df;
  border-radius: 10px;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
  background: white;
  
  &:hover {
    border-color: #0f766e;
  }
  
  &:focus {
    outline: none;
    border-color: #0f766e;
    box-shadow: 0 0 0 3px rgba(15, 118, 110, 0.15);
  }
}


.submit-img {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 1.25rem;
  margin-top: 16px;
}

.submit-img img {
  width: 100%;
  height: 150px;
  object-fit: cover;
  border-radius: 10px;
  border: 1px solid rgba(15, 118, 110, 0.15);
  box-shadow: 0 6px 14px rgba(15, 118, 110, 0.08);
}

.submit-part {
  margin-bottom: 28px;

  label.submit-name {
    margin-bottom: 10px;
  }

  input[type="text"],
  input[type="number"],
  input[type="tel"],
  input[type="email"],
  textarea,
  select {
    border: 1px solid #d4d9df;
    border-radius: 10px;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;

    &:hover {
      border-color: #0f766e;
    }

    &:focus {
      border-color: #0f766e;
      box-shadow: 0 0 0 3px rgba(15, 118, 110, 0.15);
    }
  }

  input[type="radio"] {
    width: 18px;
    height: 18px;
    accent-color: #0f766e;
    cursor: pointer;
    margin-right: 8px;
  }

  label:not(.submit-name) {
    cursor: pointer;
    color: #4b5563;

    &:hover {
      color: #0f766e;
    }
  }

  small {
    display: block;
    margin-top: 6px;
    color: #94a3b8;
    font-size: 13px;
  }

  .flex.gap-2 {
    margin-bottom: 12px;
  }

  .add-url-btn {
    padding: 0.65rem 1.25rem;
    border-radius: 10px;
    font-weight: 600;
    background: linear-gradient(135deg, #0f766e 0%, #14b8a6 100%);
    color: #ffffff;
    border: none;
    box-shadow: 0 8px 16px rgba(15, 118, 110, 0.18);
    transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;

    &:hover:not(:disabled) {
      transform: translateY(-1px);
      box-shadow: 0 10px 20px rgba(15, 118, 110, 0.22);
      background: linear-gradient(135deg, #0b5250 0%, #0f766e 100%);
    }

    &:disabled {
      opacity: 0.55;
      box-shadow: none;
      cursor: not-allowed;
    }
  }

  .upload-steps {
    margin-bottom: 12px;
    color: #4b5563;
  }

  .upload-step {
    display: flex;
    gap: 8px;
    font-size: 13px;
    line-height: 1.6;
    margin-bottom: 4px;

    &:last-child {
      margin-bottom: 0;
    }
  }

  .step-index {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 18px;
    height: 18px;
    border-radius: 999px;
    background: #0f766e;
    color: #ffffff;
    font-size: 12px;
    font-weight: 600;
    flex-shrink: 0;
    margin-top: 2px;
  }
}

.submit-button {
  display: flex;
  justify-content: space-between;
  padding-top: 1.5rem;
  gap: 12px;

  button {
    transition: background-color 0.2s ease, box-shadow 0.2s ease;
    font-weight: 600;
    border-radius: 10px;
    padding: 0.75rem 1.5rem;
  }

  .btn-light {
    background: #f8fafc;
    border: 1px solid #d4d9df;
    color: #2b3440;

    &:hover:not(:disabled) {
      background: #eef2f6;
      border-color: #0f766e;
      color: #0f766e;
    }
  }

  .btn-info {
    background: #0f766e;
    border: 1px solid #0f766e;

    &:hover:not(:disabled) {
      background: #0a5b54;
      border-color: #0a5b54;
      box-shadow: 0 6px 16px rgba(15, 118, 110, 0.2);
    }

    &:disabled {
      opacity: 0.7;
      box-shadow: none;
    }
  }
}

// åˆ†éš”ç·šæ¨£å¼
.space-y-8 > div {
  padding-bottom: 20px;

  &:not(:last-child) {
    margin-bottom: 20px;
  }
}

.divide-y > div {
  border-color: #e5e7eb;
}

// Grid ä½ˆå±€é–“è·
.grid.gap-4 {
  gap: 18px !important;
}

.grid.gap-x-4 {
  column-gap: 18px !important;
}

.grid.gap-y-6 {
  row-gap: 26px !important;
}

// å¡«å¯«è€…è³‡è¨Šå€å¡Š
.border-t {
  border-color: #e5e7eb !important;
  background: #f8fafc;
  border-radius: 12px;
  padding: 24px !important;
  margin-top: 16px;
  
  h4 {
    color: #1f2937;
    font-weight: 700;
    position: relative;
    padding-left: 14px;
    margin-bottom: 18px !important;
    
    &:before {
      content: '';
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 3px;
      height: 24px;
      background: #0f766e;
      border-radius: 999px;
    }
  }
}

// æ¨¡æ…‹æ¡†æ¨£å¼
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(15, 23, 42, 0.35);
  backdrop-filter: blur(2px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  animation: fadeIn 0.25s ease;
}

.modal-content {
  background: #ffffff;
  border-radius: 18px;
  padding: 32px;
  max-width: 420px;
  width: calc(100% - 40px);
  text-align: center;
  box-shadow: 0 18px 36px rgba(15, 118, 110, 0.15);
  animation: slideUp 0.3s ease;

  .modal-header {
    margin-bottom: 20px;

    .success-icon {
      width: 60px;
      height: 60px;
      color: #0f766e;
      margin: 0 auto 16px;
    }

    h3 {
      margin: 0;
      color: #0f172a;
      font-size: 22px;
      font-weight: 700;
    }
  }

  .modal-body {
    margin-bottom: 24px;

    p {
      color: #4b5563;
      line-height: 1.7;
      margin-bottom: 12px;
      font-size: 15px;

      &:last-child {
        margin-bottom: 0;
      }
    }
  }

  .modal-actions {
    button {
      font-weight: 600;
      transition: background-color 0.2s ease;
      background: #0f766e;
      border-radius: 10px;
      padding: 0.75rem 1.75rem;

      &:hover {
        background: #0a5b54;
      }
    }
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(30px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes scaleIn {
  from {
    opacity: 0;
    transform: scale(0);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

// éŸ¿æ‡‰å¼è¨­è¨ˆ
@media (max-width: 768px) {
  .coupon-form {
    padding: 24px;
  }
  
  .submit-title {
    font-size: 26px;
  }
  
  .modal-content {
    padding: 32px 24px;
  }
  
  .submit-button {
    flex-direction: column;
    
    button {
      width: 100%;
    }
  }
}
</style>